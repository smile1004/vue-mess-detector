(function(I,ne){typeof exports=="object"&&typeof module<"u"?ne(require("yargs"),require("util"),require("path"),require("fs"),require("assert"),require("url"),require("node:fs/promises"),require("node:path"),require("@vue/compiler-sfc")):typeof define=="function"&&define.amd?define(["yargs","util","path","fs","assert","url","node:fs/promises","node:path","@vue/compiler-sfc"],ne):(I=typeof globalThis<"u"?globalThis:I||self,ne(I.yargs,I.util,I.path,I.fs,I.assert,I.url,I["node:fs/promises"],I["node:path"],I.compilerSfc))})(this,function(I,ne,B,se,mt,en,Se,xe,tn){"use strict";var gt=typeof document<"u"?document.currentScript:null;class ae extends Error{constructor(t){super(t||"yargs error"),this.name="YError",Error.captureStackTrace&&Error.captureStackTrace(this,ae)}}function $t(){return nn()?0:1}function nn(){return sn()&&!process.defaultApp}function sn(){return!!process.versions.electron}function on(e){return e.slice($t()+1)}function rn(){return process.argv[$t()]}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */function le(e){if(e!==e.toLowerCase()&&e!==e.toUpperCase()||(e=e.toLowerCase()),e.indexOf("-")===-1&&e.indexOf("_")===-1)return e;{let n="",s=!1;const o=e.match(/^-+/);for(let i=o?o[0].length:0;i<e.length;i++){let u=e.charAt(i);s&&(s=!1,u=u.toUpperCase()),i!==0&&(u==="-"||u==="_")?s=!0:u!=="-"&&u!=="_"&&(n+=u)}return n}}function bt(e,t){const n=e.toLowerCase();t=t||"-";let s="";for(let o=0;o<e.length;o++){const i=n.charAt(o),u=e.charAt(o);i!==u&&o>0?s+=`${t}${n.charAt(o)}`:s+=u}return s}function yt(e){return e==null?!1:typeof e=="number"||/^0x[0-9a-f]+$/i.test(e)?!0:/^0[^.]/.test(e)?!1:/^[-]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(e)}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */function cn(e){if(Array.isArray(e))return e.map(u=>typeof u!="string"?u+"":u);e=e.trim();let t=0,n=null,s=null,o=null;const i=[];for(let u=0;u<e.length;u++){if(n=s,s=e.charAt(u),s===" "&&!o){n!==" "&&t++;continue}s===o?o=null:(s==="'"||s==='"')&&!o&&(o=s),i[t]||(i[t]=""),i[t]+=s}return i}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */var G;(function(e){e.BOOLEAN="boolean",e.STRING="string",e.NUMBER="number",e.ARRAY="array"})(G||(G={}));/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */let J;class an{constructor(t){J=t}parse(t,n){const s=Object.assign({alias:void 0,array:void 0,boolean:void 0,config:void 0,configObjects:void 0,configuration:void 0,coerce:void 0,count:void 0,default:void 0,envPrefix:void 0,narg:void 0,normalize:void 0,string:void 0,number:void 0,__:void 0,key:void 0},n),o=cn(t),i=typeof t=="string",u=ln(Object.assign(Object.create(null),s.alias)),h=Object.assign({"boolean-negation":!0,"camel-case-expansion":!0,"combine-arrays":!1,"dot-notation":!0,"duplicate-arguments-array":!0,"flatten-duplicate-arrays":!0,"greedy-arrays":!0,"halt-at-non-option":!1,"nargs-eats-options":!1,"negation-prefix":"no-","parse-numbers":!0,"parse-positional-numbers":!0,"populate--":!1,"set-placeholder-key":!1,"short-option-groups":!0,"strip-aliased":!1,"strip-dashed":!1,"unknown-options-as-args":!1},s.configuration),g=Object.assign(Object.create(null),s.default),w=s.configObjects||[],A=s.envPrefix,j=h["populate--"],F=j?"--":"_",ie=Object.create(null),Kt=Object.create(null),re=s.__||J.format,f={aliases:Object.create(null),arrays:Object.create(null),bools:Object.create(null),strings:Object.create(null),numbers:Object.create(null),counts:Object.create(null),normalize:Object.create(null),configs:Object.create(null),nargs:Object.create(null),coercions:Object.create(null),keys:[]},Y=/^-([0-9]+(\.[0-9]+)?|\.[0-9]+)$/,ft=new RegExp("^--"+h["negation-prefix"]+"(.+)");[].concat(s.array||[]).filter(Boolean).forEach(function(r){const a=typeof r=="object"?r.key:r,d=Object.keys(r).map(function(l){return{boolean:"bools",string:"strings",number:"numbers"}[l]}).filter(Boolean).pop();d&&(f[d][a]=!0),f.arrays[a]=!0,f.keys.push(a)}),[].concat(s.boolean||[]).filter(Boolean).forEach(function(r){f.bools[r]=!0,f.keys.push(r)}),[].concat(s.string||[]).filter(Boolean).forEach(function(r){f.strings[r]=!0,f.keys.push(r)}),[].concat(s.number||[]).filter(Boolean).forEach(function(r){f.numbers[r]=!0,f.keys.push(r)}),[].concat(s.count||[]).filter(Boolean).forEach(function(r){f.counts[r]=!0,f.keys.push(r)}),[].concat(s.normalize||[]).filter(Boolean).forEach(function(r){f.normalize[r]=!0,f.keys.push(r)}),typeof s.narg=="object"&&Object.entries(s.narg).forEach(([r,a])=>{typeof a=="number"&&(f.nargs[r]=a,f.keys.push(r))}),typeof s.coerce=="object"&&Object.entries(s.coerce).forEach(([r,a])=>{typeof a=="function"&&(f.coercions[r]=a,f.keys.push(r))}),typeof s.config<"u"&&(Array.isArray(s.config)||typeof s.config=="string"?[].concat(s.config).filter(Boolean).forEach(function(r){f.configs[r]=!0}):typeof s.config=="object"&&Object.entries(s.config).forEach(([r,a])=>{(typeof a=="boolean"||typeof a=="function")&&(f.configs[r]=a)})),Oo(s.key,u,s.default,f.arrays),Object.keys(g).forEach(function(r){(f.aliases[r]||[]).forEach(function(a){g[a]=g[r]})});let Z=null;Ro();let Ee=[];const T=Object.assign(Object.create(null),{_:[]}),Qt={};for(let r=0;r<o.length;r++){const a=o[r],d=a.replace(/^-{3,}/,"---");let l,c,$,m,y,P;if(a!=="--"&&/^-/.test(a)&&Oe(a))ht(a);else if(d.match(/^---+(=|$)/)){ht(a);continue}else if(a.match(/^--.+=/)||!h["short-option-groups"]&&a.match(/^-.+=/))m=a.match(/^--?([^=]+)=([\s\S]*)$/),m!==null&&Array.isArray(m)&&m.length>=3&&(v(m[1],f.arrays)?r=we(r,m[1],o,m[2]):v(m[1],f.nargs)!==!1?r=ve(r,m[1],o,m[2]):N(m[1],m[2],!0));else if(a.match(ft)&&h["boolean-negation"])m=a.match(ft),m!==null&&Array.isArray(m)&&m.length>=2&&(c=m[1],N(c,v(c,f.arrays)?[!1]:!1));else if(a.match(/^--.+/)||!h["short-option-groups"]&&a.match(/^-[^-]+/))m=a.match(/^--?(.+)/),m!==null&&Array.isArray(m)&&m.length>=2&&(c=m[1],v(c,f.arrays)?r=we(r,c,o):v(c,f.nargs)!==!1?r=ve(r,c,o):(y=o[r+1],y!==void 0&&(!y.match(/^-/)||y.match(Y))&&!v(c,f.bools)&&!v(c,f.counts)||/^(true|false)$/.test(y)?(N(c,y),r++):N(c,ce(c))));else if(a.match(/^-.\..+=/))m=a.match(/^-([^=]+)=([\s\S]*)$/),m!==null&&Array.isArray(m)&&m.length>=3&&N(m[1],m[2]);else if(a.match(/^-.\..+/)&&!a.match(Y))y=o[r+1],m=a.match(/^-(.\..+)/),m!==null&&Array.isArray(m)&&m.length>=2&&(c=m[1],y!==void 0&&!y.match(/^-/)&&!v(c,f.bools)&&!v(c,f.counts)?(N(c,y),r++):N(c,ce(c)));else if(a.match(/^-[^-]+/)&&!a.match(Y)){$=a.slice(1,-1).split(""),l=!1;for(let W=0;W<$.length;W++){if(y=a.slice(W+2),$[W+1]&&$[W+1]==="="){P=a.slice(W+3),c=$[W],v(c,f.arrays)?r=we(r,c,o,P):v(c,f.nargs)!==!1?r=ve(r,c,o,P):N(c,P),l=!0;break}if(y==="-"){N($[W],y);continue}if(/[A-Za-z]/.test($[W])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(y)&&v(y,f.bools)===!1){N($[W],y),l=!0;break}if($[W+1]&&$[W+1].match(/\W/)){N($[W],y),l=!0;break}else N($[W],ce($[W]))}c=a.slice(-1)[0],!l&&c!=="-"&&(v(c,f.arrays)?r=we(r,c,o):v(c,f.nargs)!==!1?r=ve(r,c,o):(y=o[r+1],y!==void 0&&(!/^(-|--)[^-]/.test(y)||y.match(Y))&&!v(c,f.bools)&&!v(c,f.counts)||/^(true|false)$/.test(y)?(N(c,y),r++):N(c,ce(c))))}else if(a.match(/^-[0-9]$/)&&a.match(Y)&&v(a.slice(1),f.bools))c=a.slice(1),N(c,ce(c));else if(a==="--"){Ee=o.slice(r+1);break}else if(h["halt-at-non-option"]){Ee=o.slice(r);break}else ht(a)}Xt(T,!0),Xt(T,!1),Eo(T),vo(),Yt(T,f.aliases,g,!0),wo(T),h["set-placeholder-key"]&&Ao(T),Object.keys(f.counts).forEach(function(r){de(T,r.split("."))||N(r,0)}),j&&Ee.length&&(T[F]=[]),Ee.forEach(function(r){T[F].push(r)}),h["camel-case-expansion"]&&h["strip-dashed"]&&Object.keys(T).filter(r=>r!=="--"&&r.includes("-")).forEach(r=>{delete T[r]}),h["strip-aliased"]&&[].concat(...Object.keys(u).map(r=>u[r])).forEach(r=>{h["camel-case-expansion"]&&r.includes("-")&&delete T[r.split(".").map(a=>le(a)).join(".")],delete T[r]});function ht(r){const a=Ae("_",r);(typeof a=="string"||typeof a=="number")&&T._.push(a)}function ve(r,a,d,l){let c,$=v(a,f.nargs);if($=typeof $!="number"||isNaN($)?1:$,$===0)return ee(l)||(Z=Error(re("Argument unexpected for: %s",a))),N(a,ce(a)),r;let m=ee(l)?0:1;if(h["nargs-eats-options"])d.length-(r+1)+m<$&&(Z=Error(re("Not enough arguments following: %s",a))),m=$;else{for(c=r+1;c<d.length&&(!d[c].match(/^-[^0-9]/)||d[c].match(Y)||Oe(d[c]));c++)m++;m<$&&(Z=Error(re("Not enough arguments following: %s",a)))}let y=Math.min(m,$);for(!ee(l)&&y>0&&(N(a,l),y--),c=r+1;c<y+r+1;c++)N(a,d[c]);return r+y}function we(r,a,d,l){let c=[],$=l||d[r+1];const m=v(a,f.nargs);if(v(a,f.bools)&&!/^(true|false)$/.test($))c.push(!0);else if(ee($)||ee(l)&&/^-/.test($)&&!Y.test($)&&!Oe($)){if(g[a]!==void 0){const y=g[a];c=Array.isArray(y)?y:[y]}}else{ee(l)||c.push(dt(a,l,!0));for(let y=r+1;y<d.length&&!(!h["greedy-arrays"]&&c.length>0||m&&typeof m=="number"&&c.length>=m||($=d[y],/^-/.test($)&&!Y.test($)&&!Oe($)));y++)r=y,c.push(dt(a,$,i))}return typeof m=="number"&&(m&&c.length<m||isNaN(m)&&c.length===0)&&(Z=Error(re("Not enough arguments following: %s",a))),N(a,c),r}function N(r,a,d=i){if(/-/.test(r)&&h["camel-case-expansion"]){const $=r.split(".").map(function(m){return le(m)}).join(".");Zt(r,$)}const l=dt(r,a,d),c=r.split(".");pe(T,c,l),f.aliases[r]&&f.aliases[r].forEach(function($){const m=$.split(".");pe(T,m,l)}),c.length>1&&h["dot-notation"]&&(f.aliases[c[0]]||[]).forEach(function($){let m=$.split(".");const y=[].concat(c);y.shift(),m=m.concat(y),(f.aliases[r]||[]).includes(m.join("."))||pe(T,m,l)}),v(r,f.normalize)&&!v(r,f.arrays)&&[r].concat(f.aliases[r]||[]).forEach(function(m){Object.defineProperty(Qt,m,{enumerable:!0,get(){return a},set(y){a=typeof y=="string"?J.normalize(y):y}})})}function Zt(r,a){f.aliases[r]&&f.aliases[r].length||(f.aliases[r]=[a],ie[a]=!0),f.aliases[a]&&f.aliases[a].length||Zt(a,r)}function dt(r,a,d){d&&(a=un(a)),(v(r,f.bools)||v(r,f.counts))&&typeof a=="string"&&(a=a==="true");let l=Array.isArray(a)?a.map(function(c){return Ae(r,c)}):Ae(r,a);return v(r,f.counts)&&(ee(l)||typeof l=="boolean")&&(l=Ce()),v(r,f.normalize)&&v(r,f.arrays)&&(Array.isArray(a)?l=a.map(c=>J.normalize(c)):l=J.normalize(a)),l}function Ae(r,a){return!h["parse-positional-numbers"]&&r==="_"||!v(r,f.strings)&&!v(r,f.bools)&&!Array.isArray(a)&&(yt(a)&&h["parse-numbers"]&&Number.isSafeInteger(Math.floor(parseFloat(`${a}`)))||!ee(a)&&v(r,f.numbers))&&(a=Number(a)),a}function Eo(r){const a=Object.create(null);Yt(a,f.aliases,g),Object.keys(f.configs).forEach(function(d){const l=r[d]||a[d];if(l)try{let c=null;const $=J.resolve(J.cwd(),l),m=f.configs[d];if(typeof m=="function"){try{c=m($)}catch(y){c=y}if(c instanceof Error){Z=c;return}}else c=J.require($);pt(c)}catch(c){c.name==="PermissionDenied"?Z=c:r[d]&&(Z=Error(re("Invalid JSON config file: %s",l)))}})}function pt(r,a){Object.keys(r).forEach(function(d){const l=r[d],c=a?a+"."+d:d;typeof l=="object"&&l!==null&&!Array.isArray(l)&&h["dot-notation"]?pt(l,c):(!de(T,c.split("."))||v(c,f.arrays)&&h["combine-arrays"])&&N(c,l)})}function vo(){typeof w<"u"&&w.forEach(function(r){pt(r)})}function Xt(r,a){if(typeof A>"u")return;const d=typeof A=="string"?A:"",l=J.env();Object.keys(l).forEach(function(c){if(d===""||c.lastIndexOf(d,0)===0){const $=c.split("__").map(function(m,y){return y===0&&(m=m.substring(d.length)),le(m)});(a&&f.configs[$.join(".")]||!a)&&!de(r,$)&&N($.join("."),l[c])}})}function wo(r){let a;const d=new Set;Object.keys(r).forEach(function(l){if(!d.has(l)&&(a=v(l,f.coercions),typeof a=="function"))try{const c=Ae(l,a(r[l]));[].concat(f.aliases[l]||[],l).forEach($=>{d.add($),r[$]=c})}catch(c){Z=c}})}function Ao(r){return f.keys.forEach(a=>{~a.indexOf(".")||typeof r[a]>"u"&&(r[a]=void 0)}),r}function Yt(r,a,d,l=!1){Object.keys(d).forEach(function(c){de(r,c.split("."))||(pe(r,c.split("."),d[c]),l&&(Kt[c]=!0),(a[c]||[]).forEach(function($){de(r,$.split("."))||pe(r,$.split("."),d[c])}))})}function de(r,a){let d=r;h["dot-notation"]||(a=[a.join(".")]),a.slice(0,-1).forEach(function(c){d=d[c]||{}});const l=a[a.length-1];return typeof d!="object"?!1:l in d}function pe(r,a,d){let l=r;h["dot-notation"]||(a=[a.join(".")]),a.slice(0,-1).forEach(function(P){P=Et(P),typeof l=="object"&&l[P]===void 0&&(l[P]={}),typeof l[P]!="object"||Array.isArray(l[P])?(Array.isArray(l[P])?l[P].push({}):l[P]=[l[P],{}],l=l[P][l[P].length-1]):l=l[P]});const c=Et(a[a.length-1]),$=v(a.join("."),f.arrays),m=Array.isArray(d);let y=h["duplicate-arguments-array"];!y&&v(c,f.nargs)&&(y=!0,(!ee(l[c])&&f.nargs[c]===1||Array.isArray(l[c])&&l[c].length===f.nargs[c])&&(l[c]=void 0)),d===Ce()?l[c]=Ce(l[c]):Array.isArray(l[c])?y&&$&&m?l[c]=h["flatten-duplicate-arrays"]?l[c].concat(d):(Array.isArray(l[c][0])?l[c]:[l[c]]).concat([d]):!y&&!!$==!!m?l[c]=d:l[c]=l[c].concat([d]):l[c]===void 0&&$?l[c]=m?d:[d]:y&&!(l[c]===void 0||v(c,f.counts)||v(c,f.bools))?l[c]=[l[c],d]:l[c]=d}function Oo(...r){r.forEach(function(a){Object.keys(a||{}).forEach(function(d){f.aliases[d]||(f.aliases[d]=[].concat(u[d]||[]),f.aliases[d].concat(d).forEach(function(l){if(/-/.test(l)&&h["camel-case-expansion"]){const c=le(l);c!==d&&f.aliases[d].indexOf(c)===-1&&(f.aliases[d].push(c),ie[c]=!0)}}),f.aliases[d].concat(d).forEach(function(l){if(l.length>1&&/[A-Z]/.test(l)&&h["camel-case-expansion"]){const c=bt(l,"-");c!==d&&f.aliases[d].indexOf(c)===-1&&(f.aliases[d].push(c),ie[c]=!0)}}),f.aliases[d].forEach(function(l){f.aliases[l]=[d].concat(f.aliases[d].filter(function(c){return l!==c}))}))})})}function v(r,a){const d=[].concat(f.aliases[r]||[],r),l=Object.keys(a),c=d.find($=>l.includes($));return c?a[c]:!1}function Jt(r){const a=Object.keys(f);return[].concat(a.map(l=>f[l])).some(function(l){return Array.isArray(l)?l.includes(r):l[r]})}function So(r,...a){return[].concat(...a).some(function(l){const c=r.match(l);return c&&Jt(c[1])})}function xo(r){if(r.match(Y)||!r.match(/^-[^-]+/))return!1;let a=!0,d;const l=r.slice(1).split("");for(let c=0;c<l.length;c++){if(d=r.slice(c+2),!Jt(l[c])){a=!1;break}if(l[c+1]&&l[c+1]==="="||d==="-"||/[A-Za-z]/.test(l[c])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(d)||l[c+1]&&l[c+1].match(/\W/))break}return a}function Oe(r){return h["unknown-options-as-args"]&&Co(r)}function Co(r){return r=r.replace(/^-{3,}/,"--"),r.match(Y)||xo(r)?!1:!So(r,/^-+([^=]+?)=[\s\S]*$/,ft,/^-+([^=]+?)$/,/^-+([^=]+?)-$/,/^-+([^=]+?\d+)$/,/^-+([^=]+?)\W+.*$/)}function ce(r){return!v(r,f.bools)&&!v(r,f.counts)&&`${r}`in g?g[r]:_o(No(r))}function _o(r){return{[G.BOOLEAN]:!0,[G.STRING]:"",[G.NUMBER]:void 0,[G.ARRAY]:[]}[r]}function No(r){let a=G.BOOLEAN;return v(r,f.strings)?a=G.STRING:v(r,f.numbers)?a=G.NUMBER:v(r,f.bools)?a=G.BOOLEAN:v(r,f.arrays)&&(a=G.ARRAY),a}function ee(r){return r===void 0}function Ro(){Object.keys(f.counts).find(r=>v(r,f.arrays)?(Z=Error(re("Invalid configuration: %s, opts.count excludes opts.array.",r)),!0):v(r,f.nargs)?(Z=Error(re("Invalid configuration: %s, opts.count excludes opts.narg.",r)),!0):!1)}return{aliases:Object.assign({},f.aliases),argv:Object.assign(Qt,T),configuration:h,defaulted:Object.assign({},Kt),error:Z,newAliases:Object.assign({},ie)}}}function ln(e){const t=[],n=Object.create(null);let s=!0;for(Object.keys(e).forEach(function(o){t.push([].concat(e[o],o))});s;){s=!1;for(let o=0;o<t.length;o++)for(let i=o+1;i<t.length;i++)if(t[o].filter(function(h){return t[i].indexOf(h)!==-1}).length){t[o]=t[o].concat(t[i]),t.splice(i,1),s=!0;break}}return t.forEach(function(o){o=o.filter(function(u,h,g){return g.indexOf(u)===h});const i=o.pop();i!==void 0&&typeof i=="string"&&(n[i]=o)}),n}function Ce(e){return e!==void 0?e+1:1}function Et(e){return e==="__proto__"?"___proto___":e}function un(e){return typeof e=="string"&&(e[0]==="'"||e[0]==='"')&&e[e.length-1]===e[0]?e.substring(1,e.length-1):e}/**
 * @fileoverview Main entrypoint for libraries using yargs-parser in Node.js
 * CJS and ESM environments.
 *
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */var _e,Ne,Re;const vt=process&&process.env&&process.env.YARGS_MIN_NODE_VERSION?Number(process.env.YARGS_MIN_NODE_VERSION):12,wt=(Ne=(_e=process==null?void 0:process.versions)===null||_e===void 0?void 0:_e.node)!==null&&Ne!==void 0?Ne:(Re=process==null?void 0:process.version)===null||Re===void 0?void 0:Re.slice(1);if(wt&&Number(wt.match(/^([^.]+)/)[1])<vt)throw Error(`yargs parser supports a minimum Node.js version of ${vt}. Read our version support policy: https://github.com/yargs/yargs-parser#supported-nodejs-versions`);const fn=process?process.env:{},At=new an({cwd:process.cwd,env:()=>fn,format:ne.format,normalize:B.normalize,resolve:B.resolve,require:e=>{if(typeof require<"u")return require(e);if(e.match(/\.json$/))return JSON.parse(se.readFileSync(e,"utf8"));throw Error("only .json config files are supported in ESM")}}),ue=function(t,n){return At.parse(t.slice(),n).argv};ue.detailed=function(e,t){return At.parse(e.slice(),t)},ue.camelCase=le,ue.decamelize=bt,ue.looksLikeNumber=yt;const hn={right:bn,center:yn},dn=0,me=1,pn=2,ge=3;class mn{constructor(t){var n;this.width=t.width,this.wrap=(n=t.wrap)!==null&&n!==void 0?n:!0,this.rows=[]}span(...t){const n=this.div(...t);n.span=!0}resetOutput(){this.rows=[]}div(...t){if(t.length===0&&this.div(""),this.wrap&&this.shouldApplyLayoutDSL(...t)&&typeof t[0]=="string")return this.applyLayoutDSL(t[0]);const n=t.map(s=>typeof s=="string"?this.colFromString(s):s);return this.rows.push(n),n}shouldApplyLayoutDSL(...t){return t.length===1&&typeof t[0]=="string"&&/[\t\n]/.test(t[0])}applyLayoutDSL(t){const n=t.split(`
`).map(o=>o.split("	"));let s=0;return n.forEach(o=>{o.length>1&&M.stringWidth(o[0])>s&&(s=Math.min(Math.floor(this.width*.5),M.stringWidth(o[0])))}),n.forEach(o=>{this.div(...o.map((i,u)=>({text:i.trim(),padding:this.measurePadding(i),width:u===0&&o.length>1?s:void 0})))}),this.rows[this.rows.length-1]}colFromString(t){return{text:t,padding:this.measurePadding(t)}}measurePadding(t){const n=M.stripAnsi(t);return[0,n.match(/\s*$/)[0].length,0,n.match(/^\s*/)[0].length]}toString(){const t=[];return this.rows.forEach(n=>{this.rowToString(n,t)}),t.filter(n=>!n.hidden).map(n=>n.text).join(`
`)}rowToString(t,n){return this.rasterize(t).forEach((s,o)=>{let i="";s.forEach((u,h)=>{const{width:g}=t[h],w=this.negatePadding(t[h]);let A=u;if(w>M.stringWidth(u)&&(A+=" ".repeat(w-M.stringWidth(u))),t[h].align&&t[h].align!=="left"&&this.wrap){const F=hn[t[h].align];A=F(A,w),M.stringWidth(A)<w&&(A+=" ".repeat((g||0)-M.stringWidth(A)-1))}const j=t[h].padding||[0,0,0,0];j[ge]&&(i+=" ".repeat(j[ge])),i+=Ot(t[h],A,"| "),i+=A,i+=Ot(t[h],A," |"),j[me]&&(i+=" ".repeat(j[me])),o===0&&n.length>0&&(i=this.renderInline(i,n[n.length-1]))}),n.push({text:i.replace(/ +$/,""),span:t.span})}),n}renderInline(t,n){const s=t.match(/^ */),o=s?s[0].length:0,i=n.text,u=M.stringWidth(i.trimRight());return n.span?this.wrap?o<u?t:(n.hidden=!0,i.trimRight()+" ".repeat(o-u)+t.trimLeft()):(n.hidden=!0,i+t):t}rasterize(t){const n=[],s=this.columnWidths(t);let o;return t.forEach((i,u)=>{i.width=s[u],this.wrap?o=M.wrap(i.text,this.negatePadding(i),{hard:!0}).split(`
`):o=i.text.split(`
`),i.border&&(o.unshift("."+"-".repeat(this.negatePadding(i)+2)+"."),o.push("'"+"-".repeat(this.negatePadding(i)+2)+"'")),i.padding&&(o.unshift(...new Array(i.padding[dn]||0).fill("")),o.push(...new Array(i.padding[pn]||0).fill(""))),o.forEach((h,g)=>{n[g]||n.push([]);const w=n[g];for(let A=0;A<u;A++)w[A]===void 0&&w.push("");w.push(h)})}),n}negatePadding(t){let n=t.width||0;return t.padding&&(n-=(t.padding[ge]||0)+(t.padding[me]||0)),t.border&&(n-=4),n}columnWidths(t){if(!this.wrap)return t.map(u=>u.width||M.stringWidth(u.text));let n=t.length,s=this.width;const o=t.map(u=>{if(u.width)return n--,s-=u.width,u.width}),i=n?Math.floor(s/n):0;return o.map((u,h)=>u===void 0?Math.max(i,gn(t[h])):u)}}function Ot(e,t,n){return e.border?/[.']-+[.']/.test(t)?"":t.trim().length!==0?n:"  ":""}function gn(e){const t=e.padding||[],n=1+(t[ge]||0)+(t[me]||0);return e.border?n+4:n}function $n(){return typeof process=="object"&&process.stdout&&process.stdout.columns?process.stdout.columns:80}function bn(e,t){e=e.trim();const n=M.stringWidth(e);return n<t?" ".repeat(t-n)+e:e}function yn(e,t){e=e.trim();const n=M.stringWidth(e);return n>=t?e:" ".repeat(t-n>>1)+e}let M;function En(e,t){return M=t,new mn({width:e?.width||$n(),wrap:e?.wrap})}const St=new RegExp("\x1B(?:\\[(?:\\d+[ABCDEFGJKSTm]|\\d+;\\d+[Hfm]|\\d+;\\d+;\\d+m|6n|s|u|\\?25[lh])|\\w)","g");function xt(e){return e.replace(St,"")}function vn(e,t){const[n,s]=e.match(St)||["",""];e=xt(e);let o="";for(let i=0;i<e.length;i++)i!==0&&i%t===0&&(o+=`
`),o+=e.charAt(i);return n&&s&&(o=`${n}${o}${s}`),o}function wn(e){return En(e,{stringWidth:t=>[...t].length,stripAnsi:xt,wrap:vn})}function An(e,t){let n=B.resolve(".",e),s;for(se.statSync(n).isDirectory()||(n=B.dirname(n));;){if(s=t(n,se.readdirSync(n)),s)return B.resolve(n,s);if(n=B.dirname(s=n),s===n)break}}const On={fs:{readFileSync:se.readFileSync,writeFile:se.writeFile},format:ne.format,resolve:B.resolve,exists:e=>{try{return se.statSync(e).isFile()}catch{return!1}}};let K;class Sn{constructor(t){t=t||{},this.directory=t.directory||"./locales",this.updateFiles=typeof t.updateFiles=="boolean"?t.updateFiles:!0,this.locale=t.locale||"en",this.fallbackToLanguage=typeof t.fallbackToLanguage=="boolean"?t.fallbackToLanguage:!0,this.cache=Object.create(null),this.writeQueue=[]}__(...t){if(typeof arguments[0]!="string")return this._taggedLiteral(arguments[0],...arguments);const n=t.shift();let s=function(){};return typeof t[t.length-1]=="function"&&(s=t.pop()),s=s||function(){},this.cache[this.locale]||this._readLocaleFile(),!this.cache[this.locale][n]&&this.updateFiles?(this.cache[this.locale][n]=n,this._enqueueWrite({directory:this.directory,locale:this.locale,cb:s})):s(),K.format.apply(K.format,[this.cache[this.locale][n]||n].concat(t))}__n(){const t=Array.prototype.slice.call(arguments),n=t.shift(),s=t.shift(),o=t.shift();let i=function(){};typeof t[t.length-1]=="function"&&(i=t.pop()),this.cache[this.locale]||this._readLocaleFile();let u=o===1?n:s;this.cache[this.locale][n]&&(u=this.cache[this.locale][n][o===1?"one":"other"]),!this.cache[this.locale][n]&&this.updateFiles?(this.cache[this.locale][n]={one:n,other:s},this._enqueueWrite({directory:this.directory,locale:this.locale,cb:i})):i();const h=[u];return~u.indexOf("%d")&&h.push(o),K.format.apply(K.format,h.concat(t))}setLocale(t){this.locale=t}getLocale(){return this.locale}updateLocale(t){this.cache[this.locale]||this._readLocaleFile();for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(this.cache[this.locale][n]=t[n])}_taggedLiteral(t,...n){let s="";return t.forEach(function(o,i){const u=n[i+1];s+=o,typeof u<"u"&&(s+="%s")}),this.__.apply(this,[s].concat([].slice.call(n,1)))}_enqueueWrite(t){this.writeQueue.push(t),this.writeQueue.length===1&&this._processWriteQueue()}_processWriteQueue(){const t=this,n=this.writeQueue[0],s=n.directory,o=n.locale,i=n.cb,u=this._resolveLocaleFile(s,o),h=JSON.stringify(this.cache[o],null,2);K.fs.writeFile(u,h,"utf-8",function(g){t.writeQueue.shift(),t.writeQueue.length>0&&t._processWriteQueue(),i(g)})}_readLocaleFile(){let t={};const n=this._resolveLocaleFile(this.directory,this.locale);try{K.fs.readFileSync&&(t=JSON.parse(K.fs.readFileSync(n,"utf-8")))}catch(s){if(s instanceof SyntaxError&&(s.message="syntax error in "+n),s.code==="ENOENT")t={};else throw s}this.cache[this.locale]=t}_resolveLocaleFile(t,n){let s=K.resolve(t,"./",n+".json");if(this.fallbackToLanguage&&!this._fileExistsSync(s)&&~n.lastIndexOf("_")){const o=K.resolve(t,"./",n.split("_")[0]+".json");this._fileExistsSync(o)&&(s=o)}return s}_fileExistsSync(t){return K.exists(t)}}function xn(e,t){K=t;const n=new Sn(e);return{__:n.__.bind(n),__n:n.__n.bind(n),setLocale:n.setLocale.bind(n),getLocale:n.getLocale.bind(n),updateLocale:n.updateLocale.bind(n),locale:n.locale}}const Cn=e=>xn(e,On),_n="require is not supported by ESM",Ct="loading a directory of commands is not supported yet for ESM";let fe;try{fe=en.fileURLToPath(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:gt&&gt.src||new URL("vue-mess-detector.umd.js",document.baseURI).href)}catch{fe=process.cwd()}const Nn=fe.substring(0,fe.lastIndexOf("node_modules"));mt.notStrictEqual,mt.strictEqual,ne.inspect,Nn||process.cwd(),B.basename,B.dirname,B.extname,B.relative,B.resolve,process.cwd,process.exit,process.nextTick,typeof process.stdout.columns<"u"&&process.stdout.columns,se.readFileSync,Cn({directory:B.resolve(fe,"../../../locales"),updateFiles:!1});const Q="\x1B[44m",S="\x1B[43m",D="\x1B[41m",_t="\x1B[42m",b="\x1B[0m",O="\x1B[33m",x="\x1B[36m",p="\x1B[0m",oe=Object.keys({"vue-caution":["elementSelectorsWithScoped","implicitParentChildCommunication"],"vue-essential":["globalStyle","simpleProp","singleNameComponent","vforNoKey","vifWithVfor"],"vue-recommended":["elementAttributeOrder","topLevelElementOrder"],"vue-strong":["componentFilenameCasing","componentFiles","directiveShorthands","fullWordComponentName","multiAttributeElements","propNameCasing","quotedAttributeValues","selfClosingComponents","simpleComputed","templateSimpleExpression"],rrd:["cyclomaticComplexity","deepIndentation","elseCondition","functionSize","htmlLink","ifWithoutCurlyBraces","magicNumbers","nestedTernary","parameterCount","plainScript","propsDrilling","scriptLength","shortVariableName","tooManyProps","vForWithIndexKey"]}),je=[],Le=100,Rn=(e,t)=>{if(!e)return;const n=e.content.split(`
`);n.length>Le&&je.push({filePath:t,message:`${n.length>Le*2?D:S}(${n.length} lines)${b}`})},jn=()=>{const e=[];return je.length>0&&je.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ Long <script> blocks${p}`,description:`👉 ${O}Try to refactor out the logic into composable functions or other files and keep the script block's length under ${Le} lines.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/script-length.html`,message:`${t.message} 🚨`})}),e},Fe=[],Ln=(e,t)=>{!e||e.setup||Fe.push({filePath:t,message:`${S}Plain <script> block${b} found`})},Fn=()=>{const e=[];return Fe.length>0&&Fe.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ Plain <script> blocks${p}`,description:`👉 ${O} Consider using <script setup> to leverage the new SFC <script> syntax.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/plain-script.html`,message:`${t.message} 🚨`})}),e},Tn=/^(\(.*\)|\\?.)$/;function te(e){const t=e.toString();return Tn.test(t)?t:`(?:${t})`}const Pn=/^(?:\(\?:(.+)\)|(\(?.+\)?))$/,Wn=/^(?:\(\?:(.+)\)([?+*]|{[\d,]+})?|(.+))$/;function E(e){const t=n=>E(`(?<${n}>${`${e}`.replace(Pn,"$1$2")})`);return{toString:()=>e.toString(),and:Object.assign((...n)=>E(`${e}${q(...n)}`),{referenceTo:n=>E(`${e}\\k<${n}>`)}),or:(...n)=>E(`(?:${e}|${q(...n)})`),after:(...n)=>E(`(?<=${q(...n)})${e}`),before:(...n)=>E(`${e}(?=${q(...n)})`),notAfter:(...n)=>E(`(?<!${q(...n)})${e}`),notBefore:(...n)=>E(`${e}(?!${q(...n)})`),times:Object.assign(n=>E(`${te(e)}{${n}}`),{any:()=>E(`${te(e)}*`),atLeast:n=>E(`${te(e)}{${n},}`),atMost:n=>E(`${te(e)}{0,${n}}`),between:(n,s)=>E(`${te(e)}{${n},${s}}`)}),optionally:()=>E(`${te(e)}?`),as:t,groupedAs:t,grouped:()=>E(`${e}`.replace(Wn,"($1$3)$2")),at:{lineStart:()=>E(`^${e}`),lineEnd:()=>E(`${e}$`)}}}const In=/[.*+?^${}()|[\]\\/]/g;function he(e){return E(`[${e.replace(/[-\\^\]]/g,"\\$&")}]`)}function k(e){return E(`[^${e.replace(/[-\\^\]]/g,"\\$&")}]`)}function Bn(...e){return E(`(?:${e.map(t=>q(t)).join("|")})`)}const $e=E(".");E("\\b\\w+\\b");const V=E("\\w"),z=E("\\b"),Mn=E("\\d"),R=E("\\s"),Nt=Object.assign(E("[a-zA-Z]"),{lowercase:E("[a-z]"),uppercase:E("[A-Z]")}),Rt=E("\\t"),jt=E("\\n");E("\\r"),E("\\W+"),E("\\W"),E("\\B"),E("\\D"),E("\\S"),Object.assign(E("[^a-zA-Z]"),{lowercase:E("[^a-z]"),uppercase:E("[^A-Z]")}),E("[^\\t]"),E("[^\\n]"),E("[^\\r]");function X(...e){return E(`${te(q(...e))}?`)}function q(...e){return E(e.map(t=>typeof t=="string"?t.replace(In,"\\$&"):t).join(""))}function C(...e){return E(`${te(q(...e))}+`)}const H="i",L="g",_=(...e)=>{const t=e.length>1&&(Array.isArray(e[e.length-1])||e[e.length-1]instanceof Set)?e.pop():void 0;return new RegExp(q(...e).toString(),[...t||""].join(""))},Te=[],kn=(e,t)=>{if(!e)return;const n=_(z,"else",z,[L,H]),s=e.content.match(n);s?.length&&Te.push({filePath:t,message:`else clauses found ${D}(${s.length})${b}`})},zn=()=>{const e=[];return Te.length>0&&Te.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ else conditions${p}`,description:`👉 ${O}Try to rewrite the conditions in a way that the else clause is not necessary.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/else-condition.html`,message:`${t.message} 🚨`})}),e},Pe=[],Un=5,Dn=10,Vn=(e,t)=>{if(!e)return;const n=_(z,"if",z,[L,H]),s=_(z,"else",z,[L,H]),o=_(z,"for",z,[L,H]),i=_(z,"while",z,[L,H]),u=_(z,"case",z,[L,H]),h=e.content.match(n),g=e.content.match(s),w=e.content.match(o),A=e.content.match(i),j=e.content.match(u),F=(h?.length||0)+(g?.length||0)+(w?.length||0)+(A?.length||0)+(j?.length||0);F>Un&&Pe.push({filePath:t,message:`${F>Dn?D:S}(${F})${b}`})},qn=()=>{const e=[];return Pe.length>0&&Pe.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ cyclomatic complexity${p}`,description:`👉 ${O}Try to reduce complexity.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/cyclomatic-complexity.html`,message:`${t.message} 🚨`})}),e},We=[],Hn=e=>{if(e.includes("pages"))return;const t=xe.basename(e);if(t==="App.vue")return;const n=_(Nt.uppercase);t.slice(1).match(n)?.length||We.push({filePath:e,message:`Component name is ${S}single word${b}`})},Gn=()=>{const e=[];return We.length>0&&We.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-essential ~ single name component${p}`,description:`👉 ${O}Rename the component to use multi-word name.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-essential/single-name-component.html`,message:`${t.message} 🚨`})}),e},Ie=[],Kn=(e,t)=>{e&&e.forEach(n=>{n.scoped||Ie.push({filePath:t,message:`${S}global style${b} used`})})},Qn=()=>{const e=[];return Ie.length>0&&Ie.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-essential ~ global style${p}`,description:`👉 ${O}Use <style scoped>.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-essential/global-style.html`,message:`${t.message} 🚨`})}),e},Be=[],Zn=(e,t)=>{if(!e)return;const n=_("defineProps([",[L,H]);e.content.match(n)?.length&&Be.push({filePath:t,message:`${S}Props type${b} not defined`})},Xn=()=>{const e=[];return Be.length>0&&Be.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-essential ~ simple prop${p}`,description:`👉 ${O}Add at least type definition.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-essential/simple-prop.html`,message:`${t.message} 🚨`})}),e},U=(e,t)=>{if(!t.includes(`
`))return e.split(`
`).findIndex(u=>u.includes(t))+1;const n=e.indexOf(t),s=e.slice(0,n).split(`
`).length,o=t.split(`
`).length;return s+o-1},Me=[],Yn=(e,t)=>{if(!e)return;const n=_("<",C(k(">"))," v-if",C(k(">"))," v-for",C(k(">")),">",[L,H]),s=_("<",C(k(">"))," v-for",C(k(">"))," v-if",C(k(">")),">",[L,H]),o=e.content.match(n),i=e.content.match(s);if(o?.length||i?.length){const u=o?.length?o[0]:i?.length?i[0]:"",h=U(e.content,u);Me.push({filePath:t,message:`line #${h} ${S}v-if used with v-for${b}`})}},Jn=()=>{const e=[];return Me.length>0&&Me.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-essential ~ v-if used with v-for${p}`,description:`👉 ${O}Move out the v-if to a computed property.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-essential/vif-with-vfor.html`,message:`${t.message} 🚨`})}),e},ke=[],es=(e,t)=>{if(!e)return;const n=_("<",C(k(">"))," v-for",C(k(">")),">",[L,H]),s=e.content.match(n);s?.length&&(s.some(i=>i.includes(":key"))||ke.push({filePath:t,message:`v-for used ${S}without a key${b}`}))},ts=()=>{const e=[];return ke.length>0&&ke.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-essential ~ v-for has no key${p}`,description:`👉 ${O}Add a \`:key\` property to all v-for.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-essential/vfor-no-key.html`,message:`${t.message} 🚨`})}),e},ze=[],ns=e=>{if(e.includes("pages")||e.includes("layouts"))return;const t=xe.basename(e),n=/^[A-Z][a-zA-Z0-9]+(?:(?<!^)(?=[A-Z]))*.vue$/,s=t.match(n),o=/^([a-z0-9]+-)+[a-z0-9]+\.vue$/,i=t.match(o);!s?.length&&!i?.length&&ze.push({filePath:e,message:`component name is ${S}not PascalCase, nor kebab-case.${b}`})},ss=()=>{const e=[];return ze.length>0&&ze.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-strong ~ component name is not PascalCase and not kebab-case${p}`,description:`👉 ${O}Rename the component to use PascalCase or kebab-case file name.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/component-filename-casing.html`,message:`${t.message} 🚨`})}),e},Ue=[],os=/^[a-z]+([A-Z][a-z]*)*$/,rs=(e,t)=>{if(!e)return;const n=/defineProps\({([^}]+)/g;let s;for(;(s=n.exec(e.content))!==null;)s[1].replace(/\s+/g,"").replace(/["']/g,"").split(",").map(i=>i.split(":")[0]).filter(i=>i.length).filter(i=>!os.test(i)).length&&Ue.push({filePath:t,message:`prop names are ${S}not camelCased${b}`})},is=()=>{const e=[];return Ue.length>0&&Ue.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-strong ~ prop names are not camelCased${p}`,description:`👉 ${O}Rename the props to camelCase.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/prop-name-casing.html`,message:`${t.message} 🚨`})}),e},De=[],cs=40,as=(e,t)=>{if(!e)return;const n=/{{\s*([\s\S]*?)\s*}}/g;[...e.content.matchAll(n)].map(o=>o[1].trim()).forEach(o=>{if(o.length>cs){const i=U(e.content,o),u=o.split(`
`).at(0)?.trim()||"";De.push({filePath:t,message:`line #${i} ${S}${u}${b}`})}})},ls=()=>{const e=[];return De.length>0&&De.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-strong ~ lengthy template expression${p}`,description:`👉 ${O}Refactor the expression into a computed property.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/template-simple-expression.html`,message:`${t.message} 🚨`})}),e},Ve=[],us=(e,t)=>{if(!e)return;const n=e.template,s=_("<",C(V),X(C(he(` 	
\r`))),C(k("/>")),X(C(he(` 	
\r`))),X("/"),">",["g"]),o=n?.content.match(s);if(o===null)return;const i=_(":",C(V),X(" "),"=",X(" "),k(`'"`),["g"]);o?.forEach(u=>{if(!u.includes(":"))return;const h=u.match(i);if(h?.length){const g=U(e.source,u);Ve.push({filePath:t,message:`line #${g} ${S}${h}${b}`})}})},fs=()=>{const e=[];return Ve.length>0&&Ve.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-strong ~ attribute value is not quoted${p}`,description:`👉 ${O}Use quotes for attribute values.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/quoted-attribute-values.html`,message:`${t.message} 🚨`})}),e},qe=[],hs=(e,t)=>{if(!e)return;const n=e.template,s=_("<",C(Nt.uppercase,V),X(jt,Rt),X(C(k(">"))),"></",C(V),">",["g"]),o=n?.content?.match(s);o!==null&&o?.forEach(i=>{const u=U(e.source,i),h=i.split(`
`).at(-1)?.trim()||"";qe.push({filePath:t,message:`line #${u} ${S}${h}${b}`})})},ds=()=>{const e=[];return qe.length>0&&qe.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-strong ~ component is not self closing${p}`,description:`👉 ${O}Components with no content should be self-closing.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/self-closing-components.html`,message:`${t.message} 🚨`})}),e},He=[],Lt=[],ps=["v-slot","v-bind","v-on"],ms=(e,t)=>{if(!e)return;const n=e.template;ps.forEach(s=>{if(n?.content.includes(`${s}:`)){const o=U(e.source,s);He.push({filePath:t,message:`line #${o} ${S}${s}${b}`}),Lt.some(i=>i.filePath===t)||Lt.push({filePath:t})}})},gs=()=>{const e=[];return He.length>0&&He.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-strong ~ directive shorthands not used${p}`,description:`👉 ${O}Use ":" for v-bind:, "@" for v-on: and "#" for v-slot.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/directive-shorthands.html`,message:`${t.message} 🚨`})}),e},Ge=[],$s=3,bs=e=>{const t=_(C(k("/")).grouped(),q(".vue").at.lineEnd()),n=e.match(t);if(n){const s=n[0]?.split(".vue")[0],o=_(he("bcdfghjklmnpqrstvwxyzBCDFGHJKLMNPQRSTVWXYZ"),[L]),i=s.match(o);(!i||i.length<$s)&&Ge.push({filePath:e,message:`${s} is not a ${S}full word.${b}`})}},ys=()=>{const e=[];return Ge.length>0&&Ge.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-strong ~ full-word component names${p}`,description:`👉 ${O}Component names should prefer full words over abbreviations.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/full-word-component-name.html`,message:`${t.message} 🚨`})}),e},Ke=[],Es=(e,t)=>{const n=e.toString(),s=n.indexOf("<script setup>"),o=n.indexOf("<template>"),i=n.indexOf("<style>"),u=[{name:"script",index:s},{name:"template",index:o},{name:"style",index:i}].filter(g=>g.index!==-1);u.every((g,w)=>w===0?!0:u[w-1].index<g.index)||Ke.push({filePath:t,message:`Top level elements are ${S}not following the correct order.${b}`})},vs=()=>{const e=[];return Ke.length>0&&Ke.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-recommended ~ top level element order${p}`,description:`👉 ${O}Single-File Components should always order <script>, <template>, and <style> tags consistently.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-recommended/top-level-element-order.html`,message:`${t.message} 🚨`})}),e},Qe=[],Ft=["is","v-for","v-if","v-else-if","v-else","v-show","v-cloak","v-pre","v-once","id","ref","key","v-model","v-on","v-html","v-text"],ws=(e,t)=>{if(!e)return;const n=e.content.replace(/<\/?template>/g,""),s=/<(\w+)(\s[^>]+)?>/g,o=/(\w+(?:-\w+)*)(?:="[^"]*")?/g;let i;for(;(i=s.exec(n))!==null;){const u=i[1],h=i[2];if(h){const w=Array.from(h.matchAll(o),j=>j[1]).filter(j=>Ft.includes(j));let A=-1;for(const j of w){const F=Ft.indexOf(j);if(F!==-1&&F<A){Qe.push({filePath:t,message:`tag has attributes out of order ${S}(${u})${b}`});break}A=F}}}},As=()=>{const e=[];return Qe.length>0&&Qe.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-recommended ~ element attribute order${p}`,description:`👉 ${O}The attributes of elements (including components) should be ordered consistently.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-recommended/element-attribute-order.html`,message:`${t.message} 🚨`})}),e},Ze=[],Os=5,Ss=(e,t)=>{if(!e)return;const n=_("defineProps",X("<"),X("("),"{",C($e),"}",["g","s"]),s=e.content.match(n);if(s?.length){const o=s[0].split(",").length;o>Os&&Ze.push({filePath:t,message:`props found ${D}(${o})${b}`})}},xs=()=>{const e=[];return Ze.length>0&&Ze.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ too many props${p}`,description:`👉 ${O}Try to refactor your code to use less properties.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/too-many-props.html`,message:`${t.message} 🚨`})}),e},Xe=[],Tt=20;function Cs(e,t,n){t.split(`
`).length>Tt&&Xe.push({filePath:n,message:`function ${D}(${Ls(e)})${b} is too long`})}function _s(e,t){let n="",s=t;for(;s<e.length&&/\s/.test(e[s]);)s++;if(e.slice(s,s+5)==="const")for(s+=5;s<e.length&&/\s/.test(e[s]);)s++;for(;s<e.length&&/[\w$]/.test(e[s]);)n+=e[s],s++;return n.trim()}function Ns(e,t){let n=t;for(;n<e.length&&e[n]!=="{";)n++;return n+1}function Rs(e,t){let n="",s=-1;for(;t<e.length&&e[t]!=="=";)/\w/.test(e[t])&&(n+=e[t]),t++;return t=e.indexOf("=>",t),t===-1?null:(s=t+2,{name:n,bodyStart:s})}function js(e,t){let n=1,s="",o=t;for(;o<e.length&&n>0;){const i=e[o];i==="{"&&n++,i==="}"&&n--,s+=i,o++}return{body:s,end:o}}function Ls(e){return e.replace(/^const\s*/,"")}const Fs=(e,t)=>{if(!e)return;const n=e.content,s=n.length;let o=0;for(;o<s;){let i="",u="",h=!1;if(n.slice(o,o+8)==="function")o+=8,h=!0,i=_s(n,o),o=Ns(n,o);else if(n.slice(o,o+5)==="const"){const g=Rs(n,o);g&&(h=!0,i=g.name,o=g.bodyStart)}if(h){const{body:g,end:w}=js(n,o);u=g,o=w,Cs(i,u,t)}else o++}},Ts=()=>{const e=[];return Xe.length>0&&Xe.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ function size${p}`,description:`👉 ${O}Functions must be shorter than ${Tt} lines.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/function-size.html`,message:`${t.message} 🚨`})}),e},Ye=[],Pt=3,Wt=(e,t,n)=>{const s=t.split(",").map(o=>o.trim()).filter(o=>o.length>0);s.length>Pt&&Ye.push({filePath:n,message:`function ${S}${e}${b} has ${S}${s.length}${b} parameters`})},Ps=(e,t)=>{if(!e)return;const n=/function\s+([\w$]+)\s*\(([^)]*)\)\s*\{|const\s+([\w$]+)\s*=\s*\(([^)]*)\)\s*=>\s*\{/g;let s;for(;(s=n.exec(e.content))!==null;)s[1]?Wt(s[1],s[2],t):s[3]&&Wt(s[3],s[4],t)},Ws=()=>{const e=[];return Ye.length>0&&Ye.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ parameter count${p}`,description:`👉 ${O}Max number of function parameters should be ${Pt}.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/parameter-count.html`,message:`${t.message} 🚨`})}),e},Je=[],Is=(e,t)=>{if(!e)return;const n=_("defineProps(",R.times.any(),"[",R.times.any(),C(he(`'"`),C(V),he(`'"`),R.times.any(),X(",",R.times.any())),"]",R.times.any(),")",[L]),s=_("<",C(V).grouped(),R,k(">").times.any(),":",C(V).grouped(),R.times.any(),"=",R.times.any(),'"props.',C(V).grouped(),'"',[L]);let o;const i=new Set;for(;(o=n.exec(e.content))!==null;)o[0].replace(/defineProps\(|[)[\]'"\s]/g,"").split(",").forEach(g=>i.add(g));let u;for(;(u=s.exec(e.content))!==null;){const h=u[1],g=u[2],w=u[3];i.has(w)&&g===w&&Je.push({filePath:t,message:`Prop ${S}(${w})${b} is being drilled through ${S}${h}${b} component unmodified.`})}},Bs=()=>{const e=[];return Je.length>0&&Je.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ props drilling${p}`,description:`👉 ${O}Props should not be forwarded unmodified. Consider refactoring.${p}`,message:`${t.message} 🚨`})}),e},et=[],It=4,Ms=(e,t)=>{if(!e)return;const n=/\b(?:const|var|let)\s+([a-zA-Z_$][\w$]*)/g;let s;for(;(s=n.exec(e.content))!==null;){const o=s[1];o.length<It&&et.push({filePath:t,message:`${D}(${o})${b}`})}},ks=()=>{const e=[];return et.length>0&&et.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ short variable names${p}`,description:`👉 ${O}Variable names must have a minimum length of ${It}.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/short-variable-name.html`,message:`${t.message} 🚨`})}),e},Bt=[],be=[],zs=5,Us=(e,t)=>{if(!e)return;const n=/const\s+([a-zA-Z0-9_$]+)\s*=\s*computed\(\s*\(\)\s*=>\s*{([^{}]*(?:{[^{}]*}[^{}]*)*)}\s*\)/gs,s=e.content.match(n);s?.length&&s.forEach(o=>{if(o.split(`
`).length>zs){const i=o.split(`
`)[0],u=U(e.content,i);Bt.push({filePath:t,message:`line #${u} ${S}computed${b}`}),be.push({filePath:t}),be.some(h=>h.filePath===t)||be.push({filePath:t})}})},Ds=()=>{const e=[];return be.length>0&&Bt.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-strong ~ complicated computed property${p}`,description:`👉 ${O}Refactor the computed properties to smaller ones.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/simple-computed.html`,message:`${t.message} 🚨`})}),e},tt=[],Vs=(e,t)=>{if(!e)return;const n=/app\.component\('([^']+)',\s*\{[^}]*\}\)/g;[...e.content.matchAll(n)].map(o=>o[1].trim()).forEach(o=>{const i=U(e.content.trim(),o),u=o.split(`
`).at(0)?.trim()||"";tt.push({filePath:t,message:`line #${i} ${S}(${u})${b}`})})},qs=()=>{const e=[];return tt.length>0&&tt.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-strong ~ component files${p}`,description:`👉 ${O}Whenever a build system is available to concatenate files, each component should be in its own file.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/component-files.html`,message:`${t.message} 🚨`})}),e},ye=[],Hs=(e,t)=>{if(!e)return;const n=/defineProps\(([^)]+)\)/,s=/v-model\s*=\s*"([^"]+)"/,o=_(q("$parent").or("getCurrentInstance"),[L]),i=e.content.match(n),u=e.content.match(s);if(u){const g=u[1].split(".")[0],w=i?i[1]:"";if(w.includes(g)){const A=U(e.content.trim(),w);ye.push({filePath:t,message:`line #${A} ${S}(${g})${b}`})}}const h=e.content.match(o);if(h){const g=U(e.content.trim(),h[0]);ye.push({filePath:t,message:`line #${g} ${S}(${h[0]})${b}`})}},Gs=()=>{const e=[];return ye.length>0&&ye.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-caution ~ implicit parent-child communication${p}`,description:`👉 ${O}Avoid implicit parent-child communication to maintain clear and predictable component behavior.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-caution/implicit-parent-child-communication.html`,message:`${t.message} 🚨`})}),e},nt=[],Mt=5,Ks=3,Qs=(e,t)=>{if(!e)return;const n=_(Rt.times.atLeast(Mt).or(R.times.atLeast(Ks*Mt)),[L,H]);e.content.match(n)?.forEach(o=>{const i=U(e.content,o);nt.push({filePath:t,message:`line #${i} ${S}indentation: ${o.length}${b}`})})},Zs=()=>{const e=[];return nt.length>0&&nt.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ deep indentation${p}`,description:`👉 ${O}Try to refactor your component to child components, to avoid deep indentations.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/deep-indentation.html`,message:`${t.message} 🚨`})}),e},st=[],Xs=(e,t)=>{if(!e)return;const n=_("<a",z,[L,H]),s=e.content.match(n);s?.length&&st.push({filePath:t,message:`${s?.length} ${S}html link found${b}`})},Ys=()=>{const e=[];return st.length>0&&st.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ html link${p}`,description:`👉 ${O}Use router-link or NuxtLink.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/html-link.html`,message:`${t.message} 🚨`})}),e},ot=[],Js=(e,t)=>{if(!e)return;const s=e.content.split(`
`);s.forEach((o,i)=>{const u=o.trim();if(u.startsWith("if (")&&!u.includes("{")){const h=s[i+1]?.trim();(!h||!h.startsWith("{")&&!u.endsWith("{"))&&ot.push({filePath:t,message:`line #${i} if statement without curly braces: ${D}${u}${b}`})}})},eo=()=>{const e=[];return ot.length>0&&ot.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ if without curly braces${p}`,description:`👉 ${O}All if statements must be enclosed in curly braces for better readability and maintainability.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/if-without-curly-braces.html`,message:`${t.message} 🚨`})}),e},rt=[],to=(e,t)=>{if(!e)return;const n=_(Mn,Bn(")",jt),[L]);e.content.match(n)?.forEach(o=>{const i=U(e.content,o);rt.push({filePath:t,message:`line #${i} ${S}magic number: ${o.length}${b}`})})},no=()=>{const e=[];return rt.length>0&&rt.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ magic numbers${p}`,description:`👉 ${O}Extract magic numbers to a constant.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/magic-numbers.html`,message:`magic numbers found (${t.message}) 🚨`})}),e},it=[],so=(e,t)=>{if(!e)return;const n=/<(\w+)([^>]*)>/g;let s;for(;(s=n.exec(e.content))!==null;){const o=s[1],i=s[2];i.split(/\s+/).filter(h=>h.trim()!=="").length>1&&i.split(`
`).length===1&&it.push({filePath:t,message:`Element ${S}<${o}>${b} should have its attributes on separate lines`})}},oo=()=>{const e=[];return it.length>0&&it.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-strong ~ multi-attribute elements${p}`,description:`👉 ${O}Elements with multiple attributes should span multiple lines, with one attribute per line.${p}`,message:`${t.message} 🚨`})}),e},ro=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","search","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],ct=[],io=(e,t)=>{if(!e)return;const n=/([a-z]+)\s*\{[^}]*\}/gi;e.forEach(s=>{let o;for(;(o=n.exec(s.content))!==null;){const i=o[1];ro.includes(i)&&ct.push({filePath:t,message:`${S}(${i})${b}`})}})},co=()=>{const e=[];return ct.length>0&&ct.forEach(t=>{e.push({file:t.filePath,rule:`${x}vue-caution ~ element selectors with scoped${p}`,description:`👉 ${O}Prefer class selectors over element selectors in scoped styles, because large numbers of element selectors are slow.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-caution/element-selectors-with-scoped.html`,message:`${t.message} 🚨`})}),e},at=[],ao=(e,t)=>{if(!e)return;const n=_(C($e),R,"?",R,C($e),R,":",R,C($e));e.content.match(n)?.forEach(o=>{if(o.split("?").length-1>1){const i=U(e.content,o);at.push({filePath:t,message:`line #${i} has ${S}nested ternary${b}`})}})},lo=()=>{const e=[];return at.length>0&&at.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ nested Ternary${p}`,description:`👉 ${O}/* TODO tip to fix this issue */.${p} See: https:///* TODO doc link */`,message:`${t.message} 🚨`})}),e},lt=[],uo=(e,t)=>{if(!e)return;const n=_('v-for="(',R.times.any(),C(V).grouped(),R.times.any(),",",R.times.any(),C(V).grouped(),R.times.any(),")",C(R),"in",C(R),C(V).grouped(),[L]),s=_(':key="',R.times.any(),C(V).grouped(),R.times.any(),'"',[L]),o=[...e.content.matchAll(n)],i=[...e.content.matchAll(s)];o.forEach(u=>{const[h,g,w,A]=u;i.forEach(j=>{const F=j[1];if(F===w){const ie=U(e.content.trim(),F);lt.push({filePath:t,message:`line #${ie} ${S}index is being used as :key in v-for${b}`})}})})},fo=()=>{const e=[];return lt.length>0&&lt.forEach(t=>{e.push({file:t.filePath,rule:`${x}rrd ~ VFor With Index Key${p}`,description:`👉 ${O}Avoid using index as key in v-for loops.${p} See: https://`,message:`${t.message} 🚨`})}),e},ho=(e,t)=>{const n={},s=({file:h,rule:g,title:w,description:A,message:j})=>{const F=e==="rule"?g:h;n[F]||(n[F]=[]),n[F].push({file:h,rule:g,title:w,description:A,message:j})},o=h=>{h().forEach(w=>{s(w)})};o(Gn),o(Xn),o(ts),o(Jn),o(Qn),o(ss),o(qs),o(gs),o(ys),o(oo),o(is),o(fs),o(ds),o(Ds),o(ls),o(vs),o(As),o(Gs),o(co),o(qn),o(Zs),o(zn),o(Ts),o(Ys),o(eo),o(no),o(lo),o(Ws),o(Fn),o(Bs),o(jn),o(ks),o(xs),o(fo);const i=[];return Object.keys(n).sort((h,g)=>{const w=n[h].length,A=n[g].length;return t==="desc"?A-w:w-A}).forEach(h=>{console.log(`
 - ${h}`),n[h].forEach(g=>{const w=g.message.includes(D);if(i.some(A=>A.file===g.file)){const A=i.find(j=>j.file===g.file);A&&(w?A.errors++:A.warnings++)}else i.push({file:g.file,errors:w?1:0,warnings:w?0:1});console.log(e==="file"?`   Rule: ${g.rule}`:`   File: ${g.file}`),console.log(`   Description: ${g.description}`),console.log(`   Message: ${g.message||"🚨"}
`)})}),i},po=(e,t,n)=>{const s=e.scriptSetup||e.script;console.log(`Analyzing ${t}...`);const o=t.endsWith(".vue");n.includes("vue-essential")&&(Zn(s,t),o&&(Hn(t),Kn(e.styles,t),es(e.template,t),Yn(e.template,t))),n.includes("vue-strong")&&(Us(s,t),o&&(Vs(s,t),rs(s,t),ns(t),hs(e,t),as(e.template,t),us(e,t),ms(e,t),bs(t),so(e.template,t))),n.includes("vue-recommended")&&o&&(Es(e.source,t),ws(e.template,t)),n.includes("vue-caution")&&o&&(Hs(s,t),io(e.styles,t)),n.includes("rrd")&&(Vn(s,t),Qs(s,t),kn(s,t),Fs(s,t),Js(s,t),to(s,t),ao(s,t),Ps(s,t),Is(s,t),Rn(s,t),Ms(s,t),Ss(s,t),o&&(Xs(e.template,t),Ln(e.script,t),uo(e.template,t)))},mo=1.5,kt=75,zt=85,Ut=95,go={groupBy:["rule","file"],orderBy:["asc","desc"]};function Dt(e,t){const n=go[t];return n.includes(e)||(console.error(`
Invalid option "${e}" provided for flag "${t}". Valid options are: ${n.join(", ")}.
`),process.exit(1)),e}function $o(e,t,n){const{errors:s,warnings:o}=e.reduce((u,{errors:h,warnings:g})=>({errors:u.errors+h,warnings:u.warnings+g}),{errors:0,warnings:0});console.log(`Found ${D}${Intl.NumberFormat("en-US").format(s)} errors${b}, and ${S}${Intl.NumberFormat("en-US").format(o)} warnings${b}, ${Q}${Intl.NumberFormat("en-US").format(t)} lines${b} of code in ${Q}${Intl.NumberFormat("en-US").format(n)} files${b}`);const i=Math.ceil((1-(s*mo+o)/t)*100);return i<kt&&console.log(`${D}Code health is LOW: ${i}%${b}`),i>=kt&&i<zt&&console.log(`${S}Code health is MEDIUM ${i}%${b}`),i>=zt&&i<Ut&&console.log(`${Q}Code health is OK: ${i}%${b}`),i>=Ut&&console.log(`${_t}Code health is GOOD: ${i}%${b}`),{errors:s,warnings:o}}let ut=0,Vt=0,qt=[];const bo=["cache","coverage","dist",".git","node_modules",".nuxt"],Ht=async e=>{const t=await Se.readdir(e);for(const n of t){const s=xe.join(e,n);if((await Se.stat(s)).isDirectory())bo.some(i=>s.includes(i))||await Ht(s);else if(n.endsWith(".vue")||n.endsWith(".ts")||n.endsWith(".js")){ut++;const i=await Se.readFile(s,"utf-8");Vt+=i.split(/\r\n|\r|\n/).length;const{descriptor:u}=tn.parse(i);(n.endsWith(".ts")||n.endsWith(".js"))&&(u.script={content:i}),po(u,s,qt)}}},yo=async({dir:e,apply:t=[],groupBy:n,orderBy:s})=>{console.log(`

${Q}Analyzing Vue files in ${e}${b}`);const o=oe.filter(g=>!t.includes(g));console.log(`Applying ${Q}${t.length}${b} rulesets ${Q}${t}${b}, ignoring ${Q}${o.length}${b} rulesets ${Q}${o}${b}, grouping by ${Q}${n}${b}, ordering ${Q}${s}${b}`),qt=t,await Ht(e),console.log(`Found ${Q}${ut}${b} files`);const i=ho(n,s),{errors:u,warnings:h}=$o(i,Vt,ut);!u&&!h&&console.log(`${_t}No code smells detected!${b}`)};I(on(process.argv)).command("analyze [path]","Analyze Vue files for code smells and best practices",e=>e.positional("path",{describe:"path to the Vue files",default:"./"}).option("ignore",{alias:"i",describe:"Comma-separated list of rulesets to ignore.",choices:oe,coerce:Gt("ignore"),group:"Filter Rulesets:"}).option("apply",{alias:"a",describe:"Comma-separated list of rulesets to apply.",choices:oe,coerce:Gt("apply"),group:"Filter Rulesets:"}).option("group",{alias:"g",describe:"Group results at the output",choices:["rule","file"],coerce:t=>Dt(t,"groupBy"),default:"rule",group:"Group Results:"}).option("order",{alias:"o",describe:"Order results at the output",choices:["asc","desc"],coerce:t=>Dt(t,"orderBy"),default:"asc",group:"Order Results:"}).check(t=>(t.ignore&&t.apply&&(console.error(`
${D}Cannot use both --ignore and --apply options together.${b}.

`),process.exit(1)),!0)),e=>{let t=[...oe];e.apply&&(t=e.apply),e.ignore&&(t=oe.filter(n=>!e.ignore.includes(n))),yo({dir:e.path,apply:t,groupBy:e.group,orderBy:e.order})}).help().argv;function Gt(e){return t=>{const n=t.split(","),s=n.filter(o=>!oe.includes(o));return s.length>0&&(console.error(`
${D}Invalid ${e} values: ${s.join(", ")}${b}. 
${O}Allowed values are: ${[...oe].join(", ")}${p}

`),process.exit(1)),n}}});
